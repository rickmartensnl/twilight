<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Flow for managing ratelimit tickets."><title>twilight_http_ratelimiting::ticket - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-46f98efaafac5295.ttf.woff2,FiraSans-Regular-018c141bf0843ffd.woff2,FiraSans-Medium-8f9a781e4970d388.woff2,SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2,SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-dd39b87e5fcfba68.css"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="twilight_http_ratelimiting" data-themes="" data-resource-suffix="" data-rustdoc-version="1.81.0-nightly (d8a38b000 2024-06-19)" data-channel="nightly" data-search-js="search-0fe7219eb170c82e.js" data-settings-js="settings-4313503d2e1961c2.js" ><script src="../../static.files/storage-118b08c4c78b968e.js"></script><script defer src="../sidebar-items.js"></script><script defer src="../../static.files/main-20a3ad099b048cf2.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-df360f571f6edeae.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../twilight_http_ratelimiting/index.html">twilight_http_ratelimiting</a><span class="version">0.16.0-rc.1</span></h2></div><h2 class="location"><a href="#">Module ticket</a></h2><div class="sidebar-elems"><section><ul class="block"><li><a href="#structs">Structs</a></li><li><a href="#functions">Functions</a></li></ul></section><h2><a href="../index.html">In crate twilight_http_ratelimiting</a></h2></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><h1>Module <a href="../index.html">twilight_http_ratelimiting</a>::<wbr><a class="mod" href="#">ticket</a><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><span class="out-of-band"><a class="src" href="../../src/twilight_http_ratelimiting/ticket.rs.html#1-175">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Flow for managing ratelimit tickets.</p>
<p>Tickets are the <a href="../trait.Ratelimiter.html" title="trait twilight_http_ratelimiting::Ratelimiter"><code>Ratelimiter</code></a>’s method of managing approval for a consumer
to be able to send a request.</p>
<h2 id="ratelimit-consumer"><a class="doc-anchor" href="#ratelimit-consumer">§</a>Ratelimit Consumer</h2><h3 id="1-requesting-a-ticket"><a class="doc-anchor" href="#1-requesting-a-ticket">§</a>1. Requesting a ticket</h3>
<p>Consumers of a ratelimiter will call <a href="../trait.Ratelimiter.html#tymethod.ticket" title="method twilight_http_ratelimiting::Ratelimiter::ticket"><code>Ratelimiter::ticket</code></a>.</p>
<h3 id="2-waiting-for-approval"><a class="doc-anchor" href="#2-waiting-for-approval">§</a>2. Waiting for approval</h3>
<p>In return consumers will receive a <a href="struct.TicketReceiver.html" title="struct twilight_http_ratelimiting::ticket::TicketReceiver"><code>TicketReceiver</code></a>. This must be polled
in order to know when the ratelimiter has approved a ticket.</p>
<h3 id="3-receiving-approval"><a class="doc-anchor" href="#3-receiving-approval">§</a>3. Receiving approval</h3>
<p>When a ticket is approved and the future resolves, a <a href="struct.TicketSender.html" title="struct twilight_http_ratelimiting::ticket::TicketSender"><code>TicketSender</code></a> is
provided. This must be used to provide the ratelimiter with the response’s
ratelimit headers.</p>
<h3 id="4-performing-the-request"><a class="doc-anchor" href="#4-performing-the-request">§</a>4. Performing the request</h3>
<p>Consumers may now execute the HTTP request associated with the ticket. Once
a response (or lack of one) is received, the headers <a href="../headers/index.html" title="mod twilight_http_ratelimiting::headers">must be parsed</a> and
sent to the ratelimiter via <a href="struct.TicketSender.html#method.headers" title="method twilight_http_ratelimiting::ticket::TicketSender::headers"><code>TicketSender::headers</code></a>. This completes the
cycle.</p>
<h2 id="ratelimiter"><a class="doc-anchor" href="#ratelimiter">§</a>Ratelimiter</h2><h3 id="1-initializing-a-tickets-channels"><a class="doc-anchor" href="#1-initializing-a-tickets-channels">§</a>1. Initializing a ticket’s channels</h3>
<p>Ratelimiters will accept a request for a ticket when <a href="../trait.Ratelimiter.html#tymethod.ticket" title="method twilight_http_ratelimiting::Ratelimiter::ticket"><code>Ratelimiter::ticket</code></a>
is called. You must call <a href="fn.channel.html" title="fn twilight_http_ratelimiting::ticket::channel"><code>channel</code></a> to create a channel between the
ratelimiter and the consumer.</p>
<h3 id="2-keeping-the-consumer-waiting"><a class="doc-anchor" href="#2-keeping-the-consumer-waiting">§</a>2. Keeping the consumer waiting</h3>
<p><a href="fn.channel.html" title="fn twilight_http_ratelimiting::ticket::channel"><code>channel</code></a> will return two halves: <a href="struct.TicketNotifier.html" title="struct twilight_http_ratelimiting::ticket::TicketNotifier"><code>TicketNotifier</code></a> and
<a href="struct.TicketReceiver.html" title="struct twilight_http_ratelimiting::ticket::TicketReceiver"><code>TicketReceiver</code></a>. Ratelimiters must keep the notifier and give the user
the receiver in return.</p>
<h3 id="3-notifying-the-consumer-of-ticket-approval"><a class="doc-anchor" href="#3-notifying-the-consumer-of-ticket-approval">§</a>3. Notifying the consumer of ticket approval</h3>
<p>When any ratelimits have passed and a user is free to perform their request,
call <a href="struct.TicketNotifier.html#method.available" title="method twilight_http_ratelimiting::ticket::TicketNotifier::available"><code>TicketNotifier::available</code></a>. If the user hasn’t canceled their
request for a ticket, you will receive a <a href="struct.TicketHeaders.html" title="struct twilight_http_ratelimiting::ticket::TicketHeaders"><code>TicketHeaders</code></a>.</p>
<h3 id="4-receiving-the-responses-headers"><a class="doc-anchor" href="#4-receiving-the-responses-headers">§</a>4. Receiving the response’s headers</h3>
<p>The consumer will perform their HTTP request and parse the response’s
headers. Once the headers (or lack of headers) are available the user will
send them along the channel. Poll the provided <a href="struct.TicketHeaders.html" title="struct twilight_http_ratelimiting::ticket::TicketHeaders"><code>TicketHeaders</code></a> for those
headers to complete the cycle.</p>
</div></details><h2 id="structs" class="section-header">Structs<a href="#structs" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.TicketHeaders.html" title="struct twilight_http_ratelimiting::ticket::TicketHeaders">TicketHeaders</a></div><div class="desc docblock-short">Receiver to wait for the headers sent by the API consumer.</div></li><li><div class="item-name"><a class="struct" href="struct.TicketNotifier.html" title="struct twilight_http_ratelimiting::ticket::TicketNotifier">TicketNotifier</a></div><div class="desc docblock-short">Indicate to the ratelimit consumer that their ticket has been granted and
they may now send a request.</div></li><li><div class="item-name"><a class="struct" href="struct.TicketReceiver.html" title="struct twilight_http_ratelimiting::ticket::TicketReceiver">TicketReceiver</a></div><div class="desc docblock-short">Channel receiver to wait for availability of a ratelimit ticket.</div></li><li><div class="item-name"><a class="struct" href="struct.TicketSender.html" title="struct twilight_http_ratelimiting::ticket::TicketSender">TicketSender</a></div><div class="desc docblock-short">Channel sender to send response ratelimit information to the ratelimiter.</div></li></ul><h2 id="functions" class="section-header">Functions<a href="#functions" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="fn" href="fn.channel.html" title="fn twilight_http_ratelimiting::ticket::channel">channel</a></div><div class="desc docblock-short">Produce a new channel consisting of a sender and receiver.</div></li></ul></section></div></main></body></html>